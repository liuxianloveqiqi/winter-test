# 接口文档

URL http://localhost:9090/suning

## 用户

### 创建用户

**POST /user/register**

* 请求参数

  |   名称   | 位置 |  类型  | 必选 |   说明   |    约束     |
  | :------: | :--: | :----: | :--: | :------: | :---------: |
  | username | body | string |  是  |  用户名  | 6<=长度<=15 |
  | password | body | string |  是  |   密码   | 6<=长度<=15 |
  | lockname | body | string |  是  |   昵称   | 4<=长度<=15 |
  | secretQ  | body | string |  是  | 密保问题 |     无      |
  | secretA  | body | string |  是  | 密保答案 |     无      |

* 返回示例

  正常返回

  ```
  {
  	"info": "success",
  	"status": 200
  }
  ```

  ### 登录验证

**POST /user/login**

* 请求参数

|   名称   | 位置 |  类型  | 必选 |  说明  |
| :------: | :--: | :----: | :--: | :----: |
| username | body | string |  是  | 用户名 |
| password | body | string |  是  |  密码  |

* 返回示例

  正确返回

  ```
  {
  	"info": "success",
  	"status": 200,
  "token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImxpdXhpYW42NjYiLCJleHAiOjE2NzM0NTA3NzMsImlzcyI6ImxpdXhpYW4ifQ.3v-MM2fhGaPhrUuf3t54Psle29Rlqg-35rlErYDaXyQ",
  	"username": "该用户名"
  ```

  错误返回

  ```
  {
  	"data": {
  		"error": "用户名不存在"
  	},
  	"info": "error",
  	"status": 401
  }
  ```
  
  ```
  {
  	"data": {
  		"error": "密码错误"
  	},
  	"info": "error",
  	"status": 401
  }
  ```
  
  

### 通过密保重置密码

**POST /user/secret**

* 请求参数

  |    名称     | 位置 |  类型  | 必选 |   说明   |
  | :---------: | :--: | :----: | :--: | :------: |
  |  username   | body | string |  是  |  用户名  |
  |   secretA   | body | string |  是  | 密保答案 |
  | newpassword | body | string |  是  |  新密码  |

* 返回示例

用户名不存在：

```
{
	"data": {
		"error": "用户名不存在"
	},
	"info": "error",
	"status": 401
}
```

输入正确用户名：

```
{
	"data": {
		"你的密保答案": "该用户密保答案"
	},
	"info": "success",
	"status": 200
}
```

输入密保答案错误

```
{"data":{"你的密保答案":"该用户密保答案"},"info":"success","status":200}
{"data":{"error":"输入的密保答案错误,请重新输入"},"info":"error","status":401}
```

输入密保答案正确，并且输入正确新密码

```
{"data":{"你的密保答案":"该用户密保答案"},"info":"success","status":200}
{"data":{"你的新密码":"该用户输入的新密码"},"info":"success","status":200}
```

输入密保答案正确，但是输入错误格式新密码

```
{"data":{"你的密保答案":"你最爱"},"info":"success","status":200}
{"data":{"error":"密码长度应大于等于4小于等于15"},"info":"error","status":400}
```



### 修改密码

**POST /user/resetpassword**

请求参数

|     名称      |  位置  |  类型  | 必选 |   说明    |
| :-----------: | :----: | :----: | :--: | :-------: |
|  newpassword  |  body  | string |  是  |  用户名   |
| Authorization | header | string |  是  | token凭证 |

返回示例

正确返回

```
{
	"data": {
		"你的新密码": "该用户设置的新密码"
	},
	"info": "success",
	"status": 200
}
```

没有携带token

```
{
  "error": "请求未携带token，无权限访问",
  "info": "error",
  "status": 401
}
```

token错误

```
{
  "data": {
    "error": "无效的token"
  },
  "info": "error",
  "status": 401
}
```

密码格式错误

```
{
  "data": {
    "error": "密码长度应大于等于4小于等于15"
  },
  "info": "error",
  "status": 401
}
```

### 用户退出

**GET user/logout**

- 返回示例

正确返回

```
{
  "info": "success",
  "status": 200
}
```

错误返回

没有携带token

```
{
  "error": "请求未携带token，无权限访问",
  "info": "error",
  "status": 401
}
```

token错误

```
{
  "data": {
    "error": "无效的token"
  },
  "info": "error",
  "status": 401
}
```

## 主页

### 搜索商品，并按照不同规则排序（销量、评价、价格等）

**GET /products/search**

请求参数

| 名称  | 位置  |  类型  | 必选 |      说明      | 限制                         |
| :---: | :---: | :----: | :--: | :------------: | ---------------------------- |
| query | query | string |  是  |      搜索      | 无                           |
| sort  | query | string |  是  |    排序标准    | 无                           |
| order | query | string |  否  | 默认升序（asc) | 只能"asc","desc","" 三者之一 |

返回示例

```
{
  "data": [
​    {
​      "id": 10001,
​      "name": "car1",
​      "description": {
​        "String": "",
​        "Valid": false
​      },
​      "image": {
​        "String": "",
​        "Valid": false
​      },
​      "category": "car",
​      "price": 10000,
​      "stock": 1,
​      "sale": 100,
​      "rating": 5,
​      "seller": "店铺1"
​    },
​    {
​      "id": 10002,
​      "name": "car2",
​      "description": {
​        "String": "",
​        "Valid": false
​      },

​      "image": {
​        "String": "",
​        "Valid": false
​      },
​      "category": "car",
​      "price": 200,
​      "stock": 1,
​      "sale": 10,
​      "rating": 4,
​      "seller": "店铺1"
​    }
  ],
  "info": "success",
  "status": 200
}
```

### 商品分类

==**路径参数会在访问路径上用 `{}` 标明**==

**GET products/category/{:name}**

请求参数:

无

返回示例：

```
{
  "data": [
​    {
​      "id": 10001,
​      "name": "car1",
​      "description": {
​        "String": "",
​        "Valid": false
​      },
​      "image": {
​        "String": "",
​        "Valid": false
​      },
​      "category": "car",
​      "price": 10000,
​      "stock": 1,
​      "sale": 100,
​      "rating": 5,
​      "seller": "店铺1"
​    },
​    {
​      "id": 10002,
​      "name": "car2",
​      "description": {
​        "String": "",
​        "Valid": false
​      },
​      "image": {
​        "String": "",
​        "Valid": false
​      },
​      "category": "car",
​      "price": 200,
​      "stock": 1,
​      "sale": 10,
​      "rating": 4,
​      "seller": "店铺1"
​    }
  ],
  "info": "success",
  "status": 200
}
```

###  主页轮播

**GET products/rotation**

请求参数：

无

返回实例：

```
{
  "data": [
​    {
​      "id": 15752452,
​      "name": "car1",
​      "description": {
​        "String": "汽车",
​        "Valid": true
​      },
​      "image": {
​        "String": "2222",
​        "Valid": true
​      },
​      "url": {
​        "String": "111111",
​        "Valid": true
​      }
​    }
  ],
  "info": "success",
  "status": 200
}
```

